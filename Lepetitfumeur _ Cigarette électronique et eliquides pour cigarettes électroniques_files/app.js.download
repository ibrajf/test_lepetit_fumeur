var spmDomain = "https://app-spm.com";var spmInIframe=function(){try{return window.self!==window.top}catch(e){return!0}},spmGetNavigatorLocale=function(){if(navigator.languages&&navigator.languages.length)var e=navigator.languages[0];else e=navigator.userLanguage||navigator.language||navigator.browserLanguage||"en";return e=e.indexOf("-")>-1?e.replace("-","_"):e+"_"+e.toUpperCase()},spmAddLoadEvent=function(e){if(!spmInIframe()){var o=window.onload;"function"!=typeof window.onload?window.onload=e:window.onload=function(){e(),o&&o()}}},spmAddScrollEvent=function(e){if(!spmInIframe()){var o=window.onscroll;"function"!=typeof window.onscroll?window.onscroll=e:window.onscroll=function(){o&&o(),e()}}},spmAddBeforeUnloadEvent=function(e){if(!spmInIframe()){var o=window.onbeforeunload;"function"!=typeof window.onbeforeunload?window.onbeforeunload=e:window.onbeforeunload=function(){e(),o&&o()}}},spmAddVisibilityChangeEvent=function(e){if(!spmInIframe()){var o=document.onvisibilitychange;"function"!=typeof document.onvisibilitychange?document.onvisibilitychange=e:document.onvisibilitychange=function(){e(),o&&o()}}},spmAddPageHideEvent=function(e){if(!spmInIframe()){var o=window.onpagehide;"function"!=typeof window.onpagehide?window.onpagehide=e:window.onpagehide=function(){e(),o&&o()}}},spmSendXHR=function(e,o,t,n,s){void 0===s&&(s=!0);var r=spmGetXDomainRequest();null!==r&&(r.onload=function(){n(r)},r.open(e,o,s),r.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),r.send(t))},spmGetScrollPercent=function(){var e=document.documentElement,o=document.body,t="scrollTop",n="scrollHeight";return(e[t]||o[t])/((e[n]||o[n])-e.clientHeight)*100},spmAddClassToElement=function(e,o){-1===e.className.split(" ").indexOf(o)&&(e.className+=" "+o)},spmFindAncestor=function(e,o){for(;(e=e.parentElement)&&!(e.matches||e.matchesSelector).call(e,o););return e},spmIsEmail=function(e){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(e).toLowerCase())},spmAddClassToElement=function(e,o){if(e){"string"==typeof e?e=document.querySelectorAll(e):e.tagName&&(e=[e]);for(var t=0;t<e.length;t++)(" "+e[t].className+" ").indexOf(" "+o+" ")<0&&(e[t].className+=" "+o)}},spmRemoveClassFromElement=function(e,o){if(e){"string"==typeof e?e=document.querySelectorAll(e):e.tagName&&(e=[e]);for(var t=new RegExp("(^| )"+o+"($| )","g"),n=0;n<e.length;n++)e[n].className=e[n].className.replace(t," ")}},spmComponentToHex=function(e){var o=(e=parseInt(e)).toString(16);return 1===o.length?"0"+o:o},spmRgbToHex=function(e,o,t){return"#"+spmComponentToHex(e)+spmComponentToHex(o)+spmComponentToHex(t)},spmFormatRgbHexColor=function(e){var o=new RegExp(/rgb\((?:([0-9]{1,2}|1[0-9]{1,2}|2[0-4][0-9]|25[0-5]), ?)(?:([0-9]{1,2}|1[0-9]{1,2}|2[0-4][0-9]|25[0-5]), ?)(?:([0-9]{1,2}|1[0-9]{1,2}|2[0-4][0-9]|25[0-5]))\)/),t=e.match(o);return"object"==typeof t&&null!==t?spmRgbToHex(t[1],t[2],t[3]):"#ffffff"},spmInvertColor=function(e){if(0===e.indexOf("#")&&(e=e.slice(1)),3===e.length&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),6!==e.length)throw new Error("Invalid HEX color.");return.299*parseInt(e.slice(0,2),16)+.587*parseInt(e.slice(2,4),16)+.114*parseInt(e.slice(4,6),16)>186?"#000000":"#FFFFFF"},spmCheckDisplayMatchingColors=function(e){var o=document.getElementById(e),t=window.getComputedStyle(o,null).getPropertyValue("color");t===window.getComputedStyle(o,null).getPropertyValue("background-color")&&(o.style.color=spmInvertColor(spmFormatRgbHexColor(t)))},spmEventify=function(e,o){e.push=function(t){Array.prototype.push.call(e,t),o(e)}},spmHtmlEntityDecode=function(e){var o=document.createElement("div");return o.innerHTML=e,o.childNodes[0].nodeValue},spmBase64Encode=function(e){if(window.btoa)return window.btoa(unescape(encodeURIComponent(e)));var o={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t,n,s,r,i,l,a,p="",m=0;for(e=o._utf8_encode(e);m<e.length;)r=(t=e.charCodeAt(m++))>>2,i=(3&t)<<4|(n=e.charCodeAt(m++))>>4,l=(15&n)<<2|(s=e.charCodeAt(m++))>>6,a=63&s,isNaN(n)?l=a=64:isNaN(s)&&(a=64),p=p+this._keyStr.charAt(r)+this._keyStr.charAt(i)+this._keyStr.charAt(l)+this._keyStr.charAt(a);return p},decode:function(e){var t,n,s,r,i,l,a="",p=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");p<e.length;)t=this._keyStr.indexOf(e.charAt(p++))<<2|(r=this._keyStr.indexOf(e.charAt(p++)))>>4,n=(15&r)<<4|(i=this._keyStr.indexOf(e.charAt(p++)))>>2,s=(3&i)<<6|(l=this._keyStr.indexOf(e.charAt(p++))),a+=String.fromCharCode(t),64!=i&&(a+=String.fromCharCode(n)),64!=l&&(a+=String.fromCharCode(s));return a=o._utf8_decode(a)},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");for(var o="",t=0;t<e.length;t++){var n=e.charCodeAt(t);n<128?o+=String.fromCharCode(n):n>127&&n<2048?(o+=String.fromCharCode(n>>6|192),o+=String.fromCharCode(63&n|128)):(o+=String.fromCharCode(n>>12|224),o+=String.fromCharCode(n>>6&63|128),o+=String.fromCharCode(63&n|128))}return o},_utf8_decode:function(e){for(var o="",t=0,n=c1=c2=0;t<e.length;)(n=e.charCodeAt(t))<128?(o+=String.fromCharCode(n),t++):n>191&&n<224?(c2=e.charCodeAt(t+1),o+=String.fromCharCode((31&n)<<6|63&c2),t+=2):(c2=e.charCodeAt(t+1),c3=e.charCodeAt(t+2),o+=String.fromCharCode((15&n)<<12|(63&c2)<<6|63&c3),t+=3);return o}};return o.encode(unescape(encodeURIComponent(e)))},spmGetXDomainRequest=function(){var e=null;return window.XDomainRequest?e=new XDomainRequest:window.XMLHttpRequest?e=new XMLHttpRequest:console.log("Votre navigateur ne gÃ¨re pas l'AJAX cross - domain !"),e},spmSaveData=function(data){var params="data="+spmBase64Encode(data).toString(),url=spmDomain+"/procedural_api/pages_views.php",spmXHR=spmGetXDomainRequest();null!=spmXHR&&(spmXHR.open("POST",url,!0),spmXHR.withCredentials=!0,spmXHR.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),spmXHR.send(params),spmXHR.onreadystatechange=function(){if(4==spmXHR.readyState&&200==spmXHR.status){var result=JSON.parse(spmXHR.responseText);1==result.success&&""!=result.data&&eval(result.data)}})},spmObjectToUrl=function(e,o){var t,n=[];for(t in e)if(e.hasOwnProperty(t)){var s=o?o+"["+t+"]":t,r=e[t];n.push(null!==r&&"object"==typeof r?spmObjectToUrl(r,s):encodeURIComponent(s)+"="+encodeURIComponent(r))}return n.join("&")},spmUrlBase64ToUint8Array=function(e){const o=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),t=window.atob(o),n=new Uint8Array(t.length);for(let e=0;e<t.length;++e)n[e]=t.charCodeAt(e);return n},spmUInt8ArrayToBase64String=function(e){return btoa(String.fromCharCode.apply(null,new Uint8Array(e)))},spmDeleteCookie=function(e,o){document.cookie=e+"=;path="+o+";expires=Thu, 01 Jan 1970 00:00:01 GMT;"};if(void 0===spm_wtk)var spm_wtk=[];var spmWorkflow={spmUrl:spmDomain,spmUrlValidateBox:spmDomain,spmServiceWorkerUrl:null,spmServiceWorkerScope:null,shopAppServerKey:null,pushRegistrationMode:"shopimind",spmTriggeredOnApp:!1,spmVisitorId:null,spmIdShopCustomer:null,spmRegisteredNewsletter:!1,spmEnablePopups:!0,spmOldScrollPercentage:0,spmEnabledTriggers:[],spmScrollStepsForShop:[],spmScrollStepsLaunchedForShop:[],spmFacebookInit:!1,spmFacebookAppId:!1,spmFacebookUseChat:!1,spmFacebookPageId:!1,spmGooglePlusInit:!1,spmFormTuUse:null,spmPreload:null,spmPreloadDone:!1,webPushInitialized:!1,spmCurrentPage:{},spmCssCacheDate:null,spmMinPeriodHidePushNotification:24,ready:function(e,o,t){spmWorkflow.spmVisitorId=e,spmWorkflow.spmIdShopCustomer=o,spmWorkflow.spmShopIdent=t,spmInIframe()||spmEventify(spm_wtk,function(e){spmWorkflow.checkCustomJS()}),spmWorkflow.loadStylesheet("https://media.shopimind.io/app/css/spm_fonts/css/spm_font.css"),spmWorkflow.loadStylesheet(spmWorkflow.spmUrl+"/css/SpmAPI.css?"+spmWorkflow.spmCssCacheDate,function(){if(null!==document.getElementById("spm_msg_push_notification")&&void 0!==document.getElementById("spm_msg_push_notification"))document.getElementById("spm_msg_push_notification").style.display="";else var e=window.setInterval(function(){spmWorkflow.webPushInitialized&&(null!==document.getElementById("spm_msg_push_notification")&&void 0!==document.getElementById("spm_msg_push_notification")&&(document.getElementById("spm_msg_push_notification").style.display=""),window.clearInterval(e))},200)}),window.addEventListener("message",function(e){"https://proxima.shopimind.com"===e.origin&&e.data&&e.data.fbToken&&spmWorkflow.getFacebookProfile(e.data.fbToken)},!1),spmInIframe()||null===spmWorkflow.spmPreload||spmWorkflow.launchPreloadFunctions()},executePreload:function(e,o){if(null!==spmWorkflow.spmPreload&&void 0!==spmWorkflow.spmPreload[e]){var t;if(null===o)t=spmWorkflow.spmPreload[e];else{if(void 0===spmWorkflow.spmPreload[e][o])return;t=spmWorkflow.spmPreload[e][o]}var n=JSON.parse(JSON.stringify(t));"object"==typeof n&&n.length>0&&(n.forEach(function(t){var n=new Array;spmWorkflow.validateBox(n,t),Array.isArray(n)&&n.length>0&&spmSendXHR("POST",spmWorkflow.spmUrlValidateBox+"/procedural_api/workflows.php","action=validateBox&shopIdent="+spmWorkflow.spmShopIdent+"&visitorId="+spmWorkflow.spmVisitorId+"&boxes="+encodeURIComponent(JSON.stringify(n)),function(e){var o=JSON.parse(e.responseText);if(o.success){if(Array.isArray(o.result)&&o.result.length>0&&o.result.forEach(function(e){if(void 0!==e.idSend&&e.idSend>0){var o=document.getElementById("spm_body-"+e.selector);if(void 0!==o&&null!=o)for(var t=["href","action","onclick"],n=0;n<t.length;n++){var s=t[n],r=o.querySelectorAll("*["+s+'*="_id_send_"]');if(r.length>0)for(var i=0;i<r.length;i++){var l=r[i];l.setAttribute(s,l.getAttribute(s).split("_id_send_").join(e.idSend))}}}}),document.getElementsByClassName("spm_close_button").length>0)for(var t=0;t<document.getElementsByClassName("spm_close_button").length;t++)document.getElementsByClassName("spm_close_button")[t].onclick=function(){spmFindAncestor(this,".spm_display").remove()};if(document.querySelectorAll("[data-spm_auto_close]").length>0){var n=document.querySelectorAll("[data-spm_auto_close]"),s=[];for(t=0;t<n.length;t++){var r=n[t],i=parseInt(r.getAttribute("data-spm_auto_close"));s[r.getAttribute("id")]=window.setTimeout(function(e){e.remove()},1e3*i,r),r.addEventListener("mouseenter",function(e){window.clearTimeout(s[this.getAttribute("id")])},!1),r.addEventListener("click",function(e){window.clearTimeout(s[this.getAttribute("id")])}),r.addEventListener("touchstart",function(e){window.clearTimeout(s[this.getAttribute("id")])})}}var l=document.querySelectorAll('input[type="checkbox"][name$="create_account"]');if(l.length>0)for(t=0;t<l.length;t++){l[t].addEventListener("change",function(){var e=spmFindAncestor(this,"form");this.checked?(spmRemoveClassFromElement(spmFindAncestor(e.querySelector("#spm_form_registration_last_name"),"div"),"spm_hidden"),spmRemoveClassFromElement(spmFindAncestor(e.querySelector("#spm_form_registration_first_name"),"div"),"spm_hidden"),spmRemoveClassFromElement(e.querySelector("div.spm_form_password"),"spm_hidden")):(null==spmFindAncestor(document.querySelector("#spm_form_registration_last_name"),".spm_form_field_choosen")&&spmAddClassToElement(spmFindAncestor(e.querySelector("#spm_form_registration_last_name"),"div"),"spm_hidden"),null==spmFindAncestor(document.querySelector("#spm_form_registration_first_name"),".spm_form_field_choosen")&&spmAddClassToElement(spmFindAncestor(e.querySelector("#spm_form_registration_first_name"),"div"),"spm_hidden"),spmAddClassToElement(e.querySelector("div.spm_form_password"),"spm_hidden"))})}}}),null===o?spmWorkflow.spmPreload[e].splice(0,1):spmWorkflow.spmPreload[e][o].splice(0,1)}),null!==o&&0===spmWorkflow.spmPreload[e][o].length&&delete spmWorkflow.spmPreload[e][o],(Array.isArray(spmWorkflow.spmPreload[e])&&0===spmWorkflow.spmPreload[e].length||0===Object.keys(spmWorkflow.spmPreload[e]).length)&&delete spmWorkflow.spmPreload[e])}},validateBox:function(boxesForValidation,box){var stepObject={id_step:box.id_step};if(void 0!==box.redirect&&(stepObject.redirect=box.redirect),void 0!==box.class&&(stepObject.boxClass=box.class),void 0!==box.type&&(stepObject.boxType=box.type),void 0!==box.send_key&&(stepObject.sendKey=box.send_key),void 0!==box.id_content&&(stepObject.idContent=box.id_content),void 0!==box.products_ids&&(stepObject.productsIds=box.products_ids),void 0!==box.parameters&&(stepObject.parameters=box.parameters),void 0!==box.selector&&(stepObject.selector=box.selector),void 0!==box.output&&(stepObject.output=box.output),void 0!==box.idVisitor&&(stepObject.idVisitor=box.idVisitor),void 0!==box.idShopCustomer?stepObject.idShopCustomer=box.idShopCustomer:spmWorkflow.spmIdShopCustomer>0&&(stepObject.idShopCustomer=spmWorkflow.spmIdShopCustomer),void 0!==box.date_execution&&(stepObject.dateExecution=box.date_execution),void 0!==box.doNotValidate&&(stepObject.doNotValidate=box.doNotValidate),stepObject.data_first={},"boxdisplayfreepopup"!==box.type||"boxdisplayfreepopup"===box.type&&0===document.getElementsByClassName("spm_popin").length&&spmWorkflow.spmEnablePopups){boxesForValidation.push(stepObject);var executeBoxChild=!0;if(void 0!==box.conditions)for(var i=0;i<box.conditions.length;i++){var condition=box.conditions[i];if(void 0!==condition){if("isnotcustomer"===condition&&spmWorkflow.spmIdShopCustomer>0){executeBoxChild=!1;break}if("isnotregisterednewsletter"===condition&&!0===spmWorkflow.spmRegisteredNewsletter){executeBoxChild=!1;break}}}if(executeBoxChild&&"boxdisplayfreepopup"===box.type&&!spmWorkflow.spmEnablePopups&&(executeBoxChild=!1),executeBoxChild)if(void 0!==box.passthrough&&!Array.isArray(box.then)&&Object.keys(box.then).length>0)spmWorkflow.validateBox(boxesForValidation,box.then);else if(void 0!==box.execute&&"error"!==box.execute)eval(box.execute),!Array.isArray(box.then)&&Object.keys(box.then).length>0&&spmWorkflow.validateBox(boxesForValidation,box.then);else if(void 0!==box.then&&!Array.isArray(box.then)&&Object.keys(box.then).length>0)spmWorkflow.validateBox(boxesForValidation,box.then);else{var key=Object.keys(box)[0];-1===Object.keys(spmWorkflow.spmPreload).indexOf(key)&&(spmWorkflow.spmPreload[key]={});var subkey=Object.keys(box[key])[0];-1===Object.keys(spmWorkflow.spmPreload[key]).indexOf(subkey)&&(spmWorkflow.spmPreload[key][subkey]=[]),spmWorkflow.spmPreload[key][subkey].push(box[key][subkey][0])}}},getTokens:function(){var e=[];return void 0!==spm_wtk&&void 0!==spm_wtk&&spm_wtk.length>0&&spm_wtk.forEach(function(o){e.push(o)}),e},checkScrollOnPage:function(){var e=spmGetScrollPercent();e-=e%10,spmWorkflow.spmOldScrollPercentage!==e&&-1===spmWorkflow.spmScrollStepsLaunchedForShop.indexOf(e)&&void 0!==spmWorkflow.spmPreload.scroll&&void 0!==spmWorkflow.spmPreload.scroll[e]&&(spmWorkflow.spmOldScrollPercentage=e,spmWorkflow.spmScrollStepsLaunchedForShop.push(e),spmWorkflow.executePreload("scroll",e))},checkCustomerLeaveSite:function(){null!==spmWorkflow.spmPreload&&document.body.addEventListener("mouseout",function(e){void 0!==spmWorkflow.spmPreload.quit&&!e.relatedTarget&&!e.toElement&&e.clientY<=0&&(spmWorkflow.spmEnablePopups=!0,spmWorkflow.executePreload("quit","quit"))})},checkPopupAuthorization:function(){if(null!==spmWorkflow.spmPreload)for(var e=document.querySelectorAll("input, textarea, select"),o=0;o<e.length;o++)e[o].addEventListener("click",function(){spmWorkflow.spmEnablePopups=!1})},checkCustomJS:function(){if(null!==spmWorkflow.spmPreload){var e=spmWorkflow.getTokens();Array.isArray(e)&&e.length>0&&e.forEach(function(e){spmWorkflow.executePreload("customjs",e)})}},checkVisit:function(){null!==spmWorkflow.spmPreload&&void 0!==spmWorkflow.spmPreload.visit&&spmWorkflow.executePreload("visit","visit")},loadScript:function(e,o){var t=document.createElement("script");t.type="text/javascript",t.readyState?t.onreadystatechange=function(){"loaded"!==t.readyState&&"complete"!==t.readyState||(t.onreadystatechange=null,void 0!==o&&o())}:t.onload=function(){void 0!==o&&o()},t.src=e,document.getElementsByTagName("head")[0].appendChild(t)},loadStylesheet:function(e,o){var t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("type","text/css"),t.setAttribute("href",e),t.readyState?t.onreadystatechange=function(){"loaded"!==t.readyState&&"complete"!==t.readyState||(t.onreadystatechange=null,void 0!==o&&o())}:t.onload=function(){void 0!==o&&o()},document.getElementsByTagName("head")[0].appendChild(t)},integrateContent:function(e,o,t,n){t=spmHtmlEntityDecode(t);var s=new RegExp(/origin="https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)?"/gi);if("string"==typeof e&&e.match(s)&&(e=e.replace(s,'origin="'+window.location.origin+'"')),"embed"==o){if(""!=t){var r="body"!=t?document.body.querySelector(t):document.body;null!=r&&("append"==n?r.insertAdjacentHTML("beforeend",e):"prepend"==n?r.insertAdjacentHTML("afterbegin",e):"before"==n?r.insertAdjacentHTML("beforebegin",e):"after"==n?r.insertAdjacentHTML("afterend",e):"replace"==n&&(r.innerHTML=e))}}else if(spmWorkflow.spmEnablePopups&&(document.getElementsByTagName("body")[0].insertAdjacentHTML("beforeend",e),document.getElementsByClassName("spm_close_button").length>0))for(var i=0;i<document.getElementsByClassName("spm_close_button").length;i++)document.getElementsByClassName("spm_close_button")[i].onclick=function(){spmFindAncestor(this,".spm_display").remove()};var l=document.querySelectorAll('input[type="checkbox"][name$="create_account"]');if(l.length>0)for(i=0;i<l.length;i++){l[i].addEventListener("change",function(){var e=spmFindAncestor(this,"form");this.checked?(spmRemoveClassFromElement(spmFindAncestor(e.querySelector("#spm_form_registration_last_name"),"div"),"spm_hidden"),spmRemoveClassFromElement(spmFindAncestor(e.querySelector("#spm_form_registration_first_name"),"div"),"spm_hidden"),spmRemoveClassFromElement(e.querySelector("div.spm_form_password"),"spm_hidden")):(null==spmFindAncestor(document.querySelector("#spm_form_registration_last_name"),".spm_form_field_choosen")&&spmAddClassToElement(spmFindAncestor(e.querySelector("#spm_form_registration_last_name"),"div"),"spm_hidden"),null==spmFindAncestor(document.querySelector("#spm_form_registration_first_name"),".spm_form_field_choosen")&&spmAddClassToElement(spmFindAncestor(e.querySelector("#spm_form_registration_first_name"),"div"),"spm_hidden"),spmAddClassToElement(e.querySelector("div.spm_form_password"),"spm_hidden"))})}var a=document.querySelectorAll('input[type="text"][name$="birthday"]');if(a.length>0)for(i=0;i<a.length;i++){var p=a[i];spmWorkflow.dateInputMask(p)}spmWorkflow.spmFacebookInit&&("string"==typeof e&&e.match("fb-messenger-checkbox")&&document.querySelectorAll('div.fb-messenger-checkbox:not([fb-xfbml-state="rendered"])').forEach(function(e){FB.XFBML.parse(spmFindAncestor(e,"div"))}));var m=new RegExp(/spm_content-\w*/gi);if("string"==typeof e&&e.match(m)){var c=e.match(m);window.setTimeout(function(){spmCheckDisplayMatchingColors(c[0])},500)}},removeDisplayTemplate:function(e,o){spmFindAncestor(e,o).remove()},getParameterByName:function(e){return new URL(window.location.href).searchParams.get(e)},generateVoucherInAction:!1,codeIsCopied:!1,generateVoucher:function(e,o,t,n,s,r){if(spmWorkflow.generateVoucherInAction)return!1;spmWorkflow.generateVoucherInAction=!0,e.style.opacity="0.6",e.style.filter="alpha(opacity=60)";var i=spmWorkflow.getParameterByName("spmRedirect");r=r!=spmWorkflow.spmVisitorId?r:spmWorkflow.spmVisitorId,spmSendXHR("POST",spmWorkflow.spmUrl+"/"+o+"/voucher/generate","shopIdent="+spmWorkflow.spmShopIdent+"&visitorId="+r+"&idTemplate="+t+"&idStepOrSendKey="+n+"&idShopCustomer="+s+"&isRedirect="+(null==i?0:1),function(o){var t=JSON.parse(o.responseText);if(t.success){var n=e.closest(".spm_triggered_button").getElementsByClassName("spm_container_voucher_code"),s=n[0].getElementsByTagName("a")[0],r=n[0].getElementsByTagName("i")[0];s.innerHTML=t.voucher,e.parentNode.remove(),n[0].classList.remove("spm_hidden"),s.classList.remove("spm_hidden"),r.classList.remove("spm_hidden"),window.setTimeout(function(){n[0].querySelectorAll("a").forEach(function(e){e.addEventListener("click",function(){if(spmWorkflow.codeIsCopied)return;const o=window.getSelection(),t=document.createRange();t.selectNodeContents(e),o.removeAllRanges(),o.addRange(t);try{document.execCommand("copy"),o.removeAllRanges(),spmWorkflow.codeIsCopied=!0;const t=e.textContent;e.textContent="CopiÃ© !",e.classList.add("spm_code_copied_success"),setTimeout(function(){e.textContent=t,e.classList.remove("spm_code_copied_success"),spmWorkflow.codeIsCopied=!1},1200)}catch(e){const o=document.querySelector(".error-msg");o.classList.add("show"),setTimeout(function(){o.classList.remove("show")},1200)}})}),spmWorkflow.generateVoucherInAction=!1},500)}else void 0!==t.message?(e.style.opacity="1",e.style.filter="alpha(opacity=100)",e.closest(".spm_triggered_button").innerHTML=t.message,spmWorkflow.generateVoucherInAction=!1):(e.remove(),spmWorkflow.generateVoucherInAction=!1)})},submitFormInAction:!1,submitForm:function(form,formAction,idTemplate,idStep,idStatsSend){if(spmWorkflow.submitFormInAction)return!1;spmWorkflow.submitFormInAction=!0,form.querySelectorAll('[class="spm_form_button"] a')[0].style.opacity="0.6",form.querySelectorAll('[class="spm_form_button"] a')[0].style.filter="alpha(opacity=60)";var defaultSubmitText=form.querySelectorAll('[class="spm_form_button"] a')[0].text,isPopup=!1,parentForm=form.parentNode.parentNode,classes=parentForm.className.split(" "),action=null,content=spmFindAncestor(parentForm,".spm_display");content.className.indexOf("spm_popin")>=0&&(isPopup=!0);for(var i=0;i<classes.length;i++)/^spm_action_/.test(classes[i])&&(action=classes[i].replace("spm_action_",""));var fields=form.querySelectorAll('[class*="spm_form_input"][class*="spm_form_required"]'),errorForm=!1;if(fields.length>0)for(var regexPwd=/password/,i=0;i<fields.length;i++){var field=fields[i],ancestor=spmFindAncestor(field,".spm_hidden");null==ancestor&&(regexPwd.test(field.name)?null!=form.querySelector('input[type="checkbox"][name$="create_account"]')&&1!=form.querySelector('input[type="checkbox"][name$="create_account"]').checked||""!=field.value?field.className.indexOf("spm_field_required_error")>=0&&field.classList.remove("spm_field_required_error"):(spmAddClassToElement(field,"spm_field_required_error"),errorForm=!0):""==field.value||/email/.test(field.name)&&!spmIsEmail(field.value)?(spmAddClassToElement(field,"spm_field_required_error"),errorForm=!0):field.className.indexOf("spm_field_required_error")>=0&&field.classList.remove("spm_field_required_error"))}if(errorForm)spmWorkflow.submitFormInAction=!1,form.querySelectorAll('[class="spm_form_button"] a')[0].text=defaultSubmitText,form.querySelectorAll('[class="spm_form_button"] a')[0].style.opacity="1",form.querySelectorAll('[class="spm_form_button"] a')[0].style.filter="alpha(opacity=100)";else{var formParams="action="+window.btoa(formAction)+"&actionValidation="+window.btoa(action)+"&shopIdent="+window.btoa(spmWorkflow.spmShopIdent)+"&visitorId="+window.btoa(spmWorkflow.spmVisitorId)+"&idTemplate="+window.btoa(idTemplate)+"&idStep="+window.btoa(idStep)+"&idStatsSend="+window.btoa(idStatsSend)+"&idShopCustomer="+window.btoa(spmWorkflow.spmIdShopCustomer),params=new Array;"displayTemplate"==action&&params.push("idTemplateRedirect="+parentForm.dataset.act);var allFields=form.querySelectorAll('[class*="spm_form_input"]');if(allFields.length>0)for(var i=0;i<allFields.length;i++){var field=allFields[i];params.push(encodeURIComponent(field.name)+"="+window.btoa(encodeURIComponent(field.value)))}var allCheckboxes=form.querySelectorAll('[class*="spm_form_checkbox"]');if(allCheckboxes.length>0)for(var i=0;i<allCheckboxes.length;i++){var field=allCheckboxes[i];1==field.checked?params.push(encodeURIComponent(field.name)+"="+window.btoa(encodeURIComponent(field.value))):params.push(encodeURIComponent(field.name)+"=")}params=params.join("&"),formParams=formParams+"&"+params,spmSendXHR("POST",spmWorkflow.spmUrl+"/display/formAction",formParams,function(spmXHR){var result=JSON.parse(spmXHR.responseText);if(result.success)switch(action){case"displayMessage":spmAddClassToElement(parentForm.getElementsByClassName("spm_step1")[0],"spm_hidden"),parentForm.getElementsByClassName("spm_step2")[0].className.indexOf("spm_hidden")>=0&&parentForm.getElementsByClassName("spm_step2")[0].classList.remove("spm_hidden"),form.querySelectorAll('[class="spm_form_button"] a')[0].style.opacity="1",form.querySelectorAll('[class="spm_form_button"] a')[0].style.filter="alpha(opacity=100)";break;case"redirectToUrl":document.location.href=window.atob(parentForm.dataset.act);break;case"displayTemplate":isPopup?spmWorkflow.removeDisplayTemplate(parentForm,".spm_display"):(form.reset(),form.querySelectorAll('[class="spm_form_button"] a')[0].style.opacity="1",form.querySelectorAll('[class="spm_form_button"] a')[0].style.filter="alpha(opacity=100)"),void 0!==result.executeJS&&eval(result.executeJS);break;case"executeJS":var code=window.atob(parentForm.dataset.act);isPopup?spmWorkflow.removeDisplayTemplate(parentForm,".spm_display"):(form.reset(),form.querySelectorAll('[class="spm_form_button"] a')[0].style.opacity="1",form.querySelectorAll('[class="spm_form_button"] a')[0].style.filter="alpha(opacity=100)"),eval(code);break;default:isPopup?spmWorkflow.removeDisplayTemplate(parentForm,".spm_display"):(form.reset(),form.querySelectorAll('[class="spm_form_button"] a')[0].style.opacity="1",form.querySelectorAll('[class="spm_form_button"] a')[0].style.filter="alpha(opacity=100)")}else void 0!==result.message&&null!=result.message&&alert(result.message),void 0!==result.field&&null!=result.field&&spmAddClassToElement(form.querySelector('[name="'+result.field+'"]'),"spm_field_required_error");spmWorkflow.submitFormInAction=!1,form.querySelectorAll('[class="spm_form_button"] a')[0].text=defaultSubmitText,form.querySelectorAll('[class="spm_form_button"] a')[0].style.opacity="1",form.querySelectorAll('[class="spm_form_button"] a')[0].style.filter="alpha(opacity=100)"})}},fillForm:function(e,o){for(var t in o){e.querySelector('[name$="'+t+'"]').value=o[t]}},initFacebook:function(e){if(spmWorkflow.spmFacebookInit)void 0!==e&&e();else{var o=spmGetNavigatorLocale(),t="https://connect.facebook.net/"+o+"/sdk.js";spmWorkflow.spmFacebookUseChat&&(t="https://connect.facebook.net/"+o+"/sdk/xfbml.customerchat.js"),void 0!==window.FB&&(window.FB=null),spmWorkflow.loadScript(t,function(){FB.init({appId:spmWorkflow.spmFacebookAppId,cookie:!0,xfbml:!0,version:"v3.3"}),FB.getLoginStatus(function(e){spmWorkflow.spmFacebookInit=!0}),FB.Event.subscribe("messenger_checkbox",function(e){"checkbox"==e.event&&("checked"==e.state&&FB.AppEvents.logEvent("MessengerCheckboxUserConfirmation",null,{app_id:spmWorkflow.spmFacebookAppId,page_id:spmWorkflow.spmFacebookPageId,user_ref:e.user_ref}))}),void 0!==e&&e()})}},initGooglePlus:function(e){spmWorkflow.spmGooglePlusInit||(window.spmAuthGapi=function(){spmWorkflow.authGapi(),void 0!==e&&e()},spmWorkflow.loadScript("https://plus.google.com/js/client:platform.js?onload=spmAuthGapi",function(){}))},authGapi:function(){gapi.load("auth2",function(){var e=gapi.auth2.init({client_id:"398768880834-u0ic7ur1s9s7nt40rc1hqa1ck76ehpnn.apps.googleusercontent.com",ux_mode:"redirect",redirect_uri:"https://proxima.shopimind.com/procedural_api/authApi.php",scope:"profile email openid"});spmWorkflow.spmGooglePlusInit=!0,e.signIn({client_id:"398768880834-u0ic7ur1s9s7nt40rc1hqa1ck76ehpnn.apps.googleusercontent.com",ux_mode:"redirect",redirect_uri:"https://proxima.shopimind.com/procedural_api/authApi.php",scope:"profile email openid"}).then(function(){})})},openFacebookLogin:function(){window.location.href="https://www.facebook.com/dialog/oauth?client_id=1951290961830126&scope=public_profile,email&type=web_server&redirect_uri="+encodeURIComponent("https://proxima.shopimind.com/procedural_api/authApi.php")},getFacebookProfile:function(e){spmWorkflow.initFacebook(function(){FB.api("/me?access_token="+e+"&fields=id,first_name,last_name,email",function(e){null!=spmWorkflow.formToUse&&(spmWorkflow.fillForm(spmWorkflow.formToUse,{last_name:e.last_name,first_name:e.first_name,email:e.email}),spmAddClassToElement(spmWorkflow.formToUse.querySelector('[class*="spm_form_other_buttons"]'),"spm_hidden"))})})},loadGooglePlusProfile:function(e){spmWorkflow.spmGooglePlusInit?gapi.signin2.render(e.id,{scope:"profile email openid",onsuccess:function(o){var t=spmFindAncestor(e,"form");spmWorkflow.fillForm(t,{last_name:o.getBasicProfile().getFamilyName(),first_name:o.getBasicProfile().getGivenName(),email:o.getBasicProfile().getEmail()}),spmAddClassToElement(t.querySelector('[class*="spm_form_other_buttons"]'),"spm_hidden"),o.disconnect()},onfailure:function(e){console.warn("Google Sign-In failure: "+e.error)}}):spmWorkflow.initGooglePlus(function(){spmWorkflow.loadGooglePlusProfile(e)})},setCookie:function(e,o,t){var n=new Date;n.setTime(n.getTime()+24*t*60*60*1e3);var s="expires="+n.toUTCString();document.cookie=e+"="+o+";"+s+";path=/"},getCookie:function(e,o,t,n){for(var s=e+"=",r=decodeURIComponent(document.cookie).split(";"),i=0;i<r.length;i++){for(var l=r[i];" "==l.charAt(0);)l=l.substring(1);if(0==l.indexOf(s))return l.substring(s.length,l.length)}return""},dateInputMask:function(e){e.addEventListener("keyup",function(o){(o.keyCode<47||o.keyCode>57)&&o.preventDefault();var t=e.value.length;1===t&&3===t||47==o.keyCode&&o.preventDefault(),2===t&&(e.value+="/"),5===t&&(e.value+="/")})},initializeWebPush:function(e,o,t,n){if(!spmWorkflow.spmCheckPushPermission()){var s=JSON.parse(n);if(s.has_endpoint)return;var r={width:550,height:405,top:200,left:200},i="https://iss.shopimind.com/push/"+e+"/"+o+"/"+t;function l(e,o,t,n,s,r,i){var l="height="+n+",width="+t+",top="+s+",left="+r+",scrollbars="+i+",resizable";return null!==document.getElementById("spmWebPushIcon")&&void 0!==document.getElementById("spmWebPushIcon")&&document.getElementById("spmWebPushIcon").remove(),null!==document.getElementById("spm_msg_push_notification")&&void 0!==document.getElementById("spm_msg_push_notification")&&document.getElementById("spm_msg_push_notification").remove(),window.open(e,o,l)}if("serviceWorker"in navigator&&"PushManager"in window&&"showNotification"in ServiceWorkerRegistration.prototype){var a=!1;if(s.notification.display_icon)if(a=!0,"self"==spmWorkflow.pushRegistrationMode)spmWorkflow.loadScript(spmWorkflow.spmServiceWorkerScope+"platform.js",function(){var e=spmWorkflow.createPushNotificationButton(s);e.addEventListener("click",function(e){spmWorkflow.spmRegisterServiceWorkerAndSubscribeToPush()}),document.body.appendChild(e)});else{var p=spmWorkflow.createPushNotificationButton(s);p.addEventListener("click",function(e){l(i,"Recevoir nos notifications",r.width,r.height,r.top,r.left,"yes")}),document.body.appendChild(p)}if(""!==spmWorkflow.getCookie("spm_no_receive_push"))return!1;s.notification.display&&(a?"self"==spmWorkflow.pushRegistrationMode?(spmWorkflow.createPushNotificationHeader(s),document.getElementById("spm_receive_push_yes_button").addEventListener("click",function(){document.getElementById("spm_msg_push_notification").style.display="none",spmWorkflow.spmRegisterServiceWorkerAndSubscribeToPush()})):(spmWorkflow.createPushNotificationHeader(s),document.getElementById("spm_receive_push_yes_button").addEventListener("click",function(e){document.getElementById("spm_msg_push_notification").style.display="none",l(i,"Recevoir nos notifications",r.width,r.height,r.top,r.left,"yes")})):"self"==spmWorkflow.pushRegistrationMode?spmWorkflow.loadScript(spmWorkflow.spmServiceWorkerScope+"platform.js",function(){spmWorkflow.createPushNotificationHeader(s),document.getElementById("spm_receive_push_yes_button").addEventListener("click",function(){document.getElementById("spm_msg_push_notification").style.display="none",spmWorkflow.spmRegisterServiceWorkerAndSubscribeToPush()})}):(spmWorkflow.createPushNotificationHeader(s),document.getElementById("spm_receive_push_yes_button").addEventListener("click",function(e){document.getElementById("spm_msg_push_notification").style.display="none",l(i,"Recevoir nos notifications",r.width,r.height,r.top,r.left,"yes")})))}}spmWorkflow.webPushInitialized=!0},spmCheckPushPermission:function(){return!("Notification"in window)||"granted"==Notification.permission||"denied"==Notification.permission},spmRegisterServiceWorkerAndSubscribeToPush:function(){navigator.serviceWorker.getRegistrations().then(function(e){var o=new RegExp("ShopimindClient"),t=!1;for(let n of e)n.scope.match(o)&&(t=!0,n.unregister().then(function(e){e&&spmWorkflow.spmRegisterServiceWorker()}));t||spmWorkflow.spmRegisterServiceWorker()})},spmRegisterServiceWorker:function(){navigator.serviceWorker.register(spmWorkflow.spmServiceWorkerUrl,{scope:spmWorkflow.spmServiceWorkerScope}).catch(e=>console.error("Unable to register service worker.",e)).then(function(e){var o;e.installing?o=e.installing:e.waiting?o=e.waiting:e.active&&(o=e.active),o&&o.addEventListener("statechange",function(o){"activated"==o.target.state&&e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:spmUrlBase64ToUint8Array(spmWorkflow.shopAppServerKey)}).then(function(e){null!==document.getElementById("spmWebPushIcon")&&void 0!==document.getElementById("spmWebPushIcon")&&document.getElementById("spmWebPushIcon").remove(),null!==document.getElementById("spm_msg_push_notification")&&void 0!==document.getElementById("spm_msg_push_notification")&&document.getElementById("spm_msg_push_notification").remove();var o={endpoint:e.endpoint,key:spmUInt8ArrayToBase64String(e.getKey("p256dh")),token:spmUInt8ArrayToBase64String(e.getKey("auth")),shopIdentifier:spmWorkflow.spmShopIdent,visitorId:spmWorkflow.spmVisitorId>0?spmWorkflow.spmVisitorId:null,idShopCustomer:spmWorkflow.spmIdShopCustomer>0?spmWorkflow.spmIdShopCustomer:null,browser_name:platform.name,browser_version:platform.version,device:platform.product||"Desktop",device_os:platform.os.toString(),registrationMode:spmWorkflow.pushRegistrationMode};fetch(spmWorkflow.spmUrl+"/push-update",{method:"POST",mode:"cors",credentials:"omit",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)})})})})},launchPreloadFunctions:function(){spmWorkflow.checkPopupAuthorization(),spmWorkflow.checkCustomerLeaveSite(),spmWorkflow.checkCustomJS(),spmWorkflow.checkVisit(),null!=spmWorkflow.spmPreload&&(spmAddScrollEvent(function(){spmWorkflow.checkScrollOnPage()}),spmAddBeforeUnloadEvent(function(){spmWorkflow.cancelStepsBasedOnEvents()}),void 0!==spmWorkflow.spmPreload.forceLoad&&spmWorkflow.spmPreload.forceLoad.length>0&&spmWorkflow.executePreload("forceLoad",null),void 0!==spmWorkflow.spmPreload.load&&spmWorkflow.spmPreload.load.length>0&&spmWorkflow.executePreload("load",null),spmWorkflow.spmPreloadDone=!0)},cancelStepsBasedOnEvents:function(){spmSendXHR("POST",spmWorkflow.spmUrl+"/procedural_api/workflows.php","action=cancelBoxesBasedOnEvents&shopIdent="+spmWorkflow.spmShopIdent+"&visitorId="+spmWorkflow.spmVisitorId+"&boxes="+encodeURIComponent(JSON.stringify(spmWorkflow.spmPreload)),function(e){})},createPushNotificationButton:function(e){var o=document.createElement("div"),t=e.notification.bg_icon||"#838383",n=e.notification.color_text_icon||"#ffffff",s='<div id="spmWebPushIcon" class="icon" style="width: '+60..toString()+"px; height: "+60..toString()+"px; border-radius: 50%; box-shadow: -8px 8px 7px -7px rgba(156,156,156,1); background-color: "+n+';"><svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 300 300" xml:space="preserve"><g><g><path fill="'+t+'" d="M149.996,0C67.157,0,0.001,67.161,0.001,149.997S67.157,300,149.996,300s150.003-67.163,150.003-150.003S232.835,0,149.996,0z M149.999,232.951c-10.766,0-19.499-8.725-19.499-19.499h38.995C169.497,224.226,160.765,232.951,149.999,232.951z M215.889,193.9h-0.005v-0.001c0,7.21-5.843,7.685-13.048,7.685H97.16c-7.208,0-13.046-0.475-13.046-7.685v-1.242c0-5.185,3.045-9.625,7.42-11.731l4.142-35.753c0-26.174,18.51-48.02,43.152-53.174v-13.88c0-6.17,5.003-11.173,11.176-11.173c6.17,0,11.173,5.003,11.173,11.173V92c24.642,5.153,43.152,26.997,43.152,53.174l4.142,35.758c4.375,2.109,7.418,6.541,7.418,11.726V193.9z"/></g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g></svg></div>';return o.innerHTML=s,o.style.position="fixed",o.style.bottom=30..toString()+"px",o.style.left=30..toString()+"px",o.style.width=60..toString()+"px",o.style.height=60..toString()+"px",o.style.cursor="pointer",o.style.zIndex="100000",o},createPushNotificationHeader:function(e){var o=e.notification.title_content||"",t=e.notification.text_content||"",n=parseInt(e.notification.display_text_in_mobile)||!1,s=e.notification.bg_color||"white",r=e.notification.title_color||"#444",i=e.notification.text_color||"#444",l=e.notification.btn_accept_bg_color||"#838383",a=e.notification.btn_accept_text_color||"#ffffff",p=e.notification.btn_accept_text||"J'accepte",m=e.notification.btn_refuse_bg_color||"#ffffff",c=e.notification.btn_refuse_text_color||"#838383",d=e.notification.btn_refuse_text||"Je refuse",u=e.notification.position_top||0,f=e.notification.position_left||20,h=e.notification.width||500,g=parseInt(e.notification.thumb_display)||!1,_=e.notification.thumb_url||"",y=parseInt(e.notification.display_thumb_in_mobile)||!1,w=e.notification.appear_effects||"none",v='<div id="spm_msg_push_notification" style="display:none; position: fixed; left: '+(f/100*document.body.clientWidth-f/100*(parseInt(h)+30))+"px; z-index: 99999; border-radius: 2px; width: "+h+"px; padding: 15px; margin: 0 auto; background-color: "+s+'; box-shadow: 0px 0px 10px 0px rgba(180,180,180,0.5);">  <div style="margin-bottom: 15px;">'+(g?'<div style="float: left; width: 120px; height: 120px; text-align: center; border: solid 1px #dedede; margin-right: 15px;position: relative;" '+(y?"":' class="spm_hidden_mobile" ')+'><img src="'+_+'" style="max-width: 100%; max-height: 100%;position: absolute;top: 50%;left: 50%;transform: translate(-50%,-50%);" /></div>':"")+'    <p style="font-size: 1.24em; color: '+r+'; font-family: sans-serif; text-align: left;">'+o+'    </p>  </div>  <p style="color: '+i+'; font-family: sans-serif; text-align: left;" id="spm_push_description" '+(n?"":' class="spm_hidden_mobile" ')+">"+t+"</p>"+(g?'<div style="clear: both;"></div>':"")+'  <div style="display: flex; justify-content: flex-end; margin-top: 30px;">    <div style="background-color: '+m+"; font-family: sans-serif; text-align: center; color: "+c+'; width: 150px; padding: 10px 0; margin-right: 15px; cursor: pointer; border-radius: 2px;"  id="spm_receive_push_no_button">'+d+'</div>    <div style="border-radius: 2px; background-color: '+l+"; font-family: sans-serif; text-align: center; color: "+a+'; width: 150px; padding: 10px 0; cursor: pointer;" id="spm_receive_push_yes_button">'+p+"</div>  </div></div>",k=document.createElement("div");k.innerHTML=v,document.body.appendChild(k);var b=u/100*window.innerHeight-u/100*document.getElementById("spm_msg_push_notification").offsetHeight;document.getElementById("spm_msg_push_notification").style.top=b+"px","none"!=w&&(document.getElementById("spm_msg_push_notification").classList.add("spm_animated"),document.getElementById("spm_msg_push_notification").classList.add("spmEffect_"+w)),document.getElementById("spm_receive_push_no_button").addEventListener("click",function(e){document.getElementById("spm_msg_push_notification").style.display="none",spmWorkflow.setCookie("spm_no_receive_push","1",3)}),""==spmWorkflow.getCookie("spm_no_receive_push")&&spmWorkflow.setCookie("spm_no_receive_push","1",spmWorkflow.spmMinPeriodHidePushNotification/24)}};!function(){var e={SCROLLUP:-1,NOSCROLL:0,SCROLLDOWN:1},o={currentPosition:0,oldPosition:0,status:e.NOSCROLL,ticking:!1};function t(){return document.querySelector('div.spm_popin  div[id*="spm_content"]')}function n(){return document.documentElement.clientHeight}function s(e){return Number(e).toString()+"px"}function r(){return Math.abs(o.oldPosition-o.currentPosition)}function i(){null!=t()&&("relative"!=t().style.position&&(t().style.position="relative"),t().scrollHeight>n()?(o.currentPosition>0&&(o.status===e.SCROLLDOWN?t().getBoundingClientRect().bottom>=n()&&(t().style.top=s(t().getBoundingClientRect().top-r())):t().getBoundingClientRect().top<0&&(t().style.top=s(t().getBoundingClientRect().top+r()))),(t().getBoundingClientRect().top>0||0===o.currentPosition)&&(t().style.top=s(0)),(t().getBoundingClientRect().bottom<n()||o.currentPosition===Math.max.apply(null,Array.prototype.slice.call(document.body.children).map(function(e){return e.scrollHeight})).scrollHeight-n())&&(t().style.top=s(n()-t().getBoundingClientRect().height))):t().style.top=s(0))}window.addEventListener("scroll",function(t){o.oldPosition=o.currentPosition,o.currentPosition=window.scrollY,o.status=o.currentPosition<o.oldPosition?e.SCROLLUP:o.oldPosition<o.currentPosition?e.SCROLLDOWN:e.NOSCROLL,o.ticking||(window.requestAnimationFrame(function(){i(),o.ticking=!1}),o.ticking=!0)});var l=setInterval(function(){null!=t()&&(t().style.removeProperty("top"),clearInterval(l))},500)}();
var startSPMAPPMaxTentative = 3;
var currentSPMAPPTentative = 1;
var appDeployed = 0;

function startSPMAPPWithTracking() {
    spmTracking = true;
    startSPMAPP();
}

function startSPMAPP() {
	if (document.readyState != "interactive" && document.readyState != "complete") {
		currentSPMAPPTentative++;
		window.setTimeout(function () {
			startSPMAPP();
		}, 10);
		return;
	}

	if (currentSPMAPPTentative >= 15 || document.readyState == "interactive" || document.readyState == "complete") {
		if (appDeployed < 1) {
			spmWorkflow.spmCurrentPage.url = '//www.lepetitfumeur.fr/';spmWorkflow.spmCurrentPage.product = '';spmWorkflow.spmCurrentPage.category = '';spmWorkflow.spmCurrentPage.manufacturer = '';spmWorkflow.webPushInitialized = true;spmWorkflow.spmCssCacheDate = "1638375381";spmWorkflow.ready("385579721", "0", "mHfNJco8");spmWorkflow.spmTriggeredOnApp = true;
			appDeployed++;
		}
	}

	if (currentSPMAPPTentative >= 15 || document.readyState == "complete") {
		var encodedSpmd = spmObjectToUrl(_spmq);
		var spmDataToSend = encodedSpmd + "&workflowsTriggeredOnApp=" + (spmWorkflow.spmTriggeredOnApp ? 1 : 0) + "&hash=f5611abc1a20b57c5d76ca2364d46607&hashLite=93ae38732d871bb15b476a3b0191c0af&id_shop=252&defaultLang=fr&oc_id=&haveRetargetingCredits=no";
		
if(appDeployed < 2) {
    spmSaveData(spmDataToSend);
    appDeployed++;
}
	} else {
		currentSPMAPPTentative++;
		window.setTimeout(function () {
			startSPMAPP();
		}, 10);
		return;
	}
}

var spmTracking = false;
var spmAppLaunched = false;

if(typeof(window._axcb) != "undefined") {
    if(document.cookie.indexOf("axeptio_cookies=") == -1) {
        spmAppLaunched = true;
        startSPMAPP();
    }
    
    window._axcb.push(function(axeptio) {
        axeptio.on("cookies:complete", function(choices) {
            if(!spmAppLaunched) {
                spmAppLaunched = true;
                
                if(choices.shopimind) {
                    startSPMAPPWithTracking();
                }
                else {
                    startSPMAPP();
                }
            }
        });
    });
}
else {		
    startSPMAPPWithTracking();
}